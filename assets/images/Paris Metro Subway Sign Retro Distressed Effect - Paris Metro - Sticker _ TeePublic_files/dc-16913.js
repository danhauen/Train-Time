!function(e,t){function n(e={},t={}){let r=Object.assign({},e);try{Object.keys(t).forEach(o=>{!function(e){return e&&"object"==typeof e&&!Array.isArray(e)}(t[o])?Object.assign(r,{[o]:t[o]}):o in e?r[o]=n(e[o],t[o]):Object.assign(r,{[o]:t[o]})})}catch(e){console.error("Could not merge deep objects\n",e)}return r}let r={api_url:"https://d10gj7yjsfriaj.cloudfront.net",autotrack:{change:!0,click:!0,submit:!0},capture_text:!0,debug:!1,event:{props:{}},flush_interval:50,local_storage_prefix:"__dc_",log_level:"silent",page:{location:e.location.href,props:{},referrer:t.referrer,title:t.title},track_history_change:!1,track_page_scroll:!1,track_page_scroll_depths:[10,20,30,40,50,60,70,80,90,100],track_pageview:!1,track_session:!0,tracking_encoding:"base64",tracking_method:"image"};function o(){return r}function i(e){const t=o().autotrack;if("boolean"==typeof e.autotrack){const n=e.autotrack;t.change=n,t.click=n,t.submit=n,e.autotrack=t}return r=n(r,e)}let s="silent";"object"==typeof global&&global.LOG_LEVEL?s=global.LOG_LEVEL:"object"==typeof e&&e.LOG_LEVEL&&(s=e.LOG_LEVEL);const a={silent:-1,critical:0,error:1,warn:2,info:3,debug:4,trace:5};let c="dc";function l(e){s=e}const u={error:function(...e){return console.error.apply(console,arguments)},log:function(e,...t){"string"==typeof t[0]&&(t[0]=`${c}: ${t[0]}`);const n=o(),r=n.debug?s:n.log_level?n.log_level:s;if(-1!=a[e]&&a[e]<=a[r]&&(console.log.apply(console,t),n.log_forward_uri)){const e=JSON.stringify({d:t[1],m:t[0]});fetch(n.log_forward_uri,{method:"POST",body:e,headers:{"Content-Type":"application/json"}})}}};var d=/\b(?:\d[ -]*?){13,16}\b/;function p(e={},t){if(t&&"set_user_properties"==t)return e;const n=o();return function(e={}){return Object.keys(e).forEach(t=>{d.test(e[t])&&(e[t]="")}),e}(Object.assign({},n.event.props,n.page.props,e))}function g(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))}function f(){return u.log("trace","create new userId"),g()}const h=(new Date).getTime();function _(){return h}let b={cookie:{duration:63072e3,path:"/"},document:null,lib:"web",lib_v:"211",mode:"browser",pageviews:1,referrer:{},session:{length:1800},trackerVersion:0,user:{hasViewedFirstPage:!1,id:null,lastActivity:_()},window:null};function y(){return b}function v(e){return b=n(b,e),u.log("trace","Settings updated",b),b}function m(){const e=y();let n=void 0;return e.referrer&&e.referrer.location?n=e.referrer.location:t.referrer&&(n=t.referrer),n}function k(e){switch(typeof e.className){case"object":return e.className.baseVal||e.getAttribute("class")||"";case"string":return e.className;default:return""}}function w(e){const t=function(e){try{return decodeURIComponent(atob(e).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}catch(e){u.error("Could not decode value\n",e)}}(e);return"string"==typeof t&&(t.indexOf("[")>-1||t.indexOf("{")>-1)?JSON.parse(t):t}function I(e){const t=o();return t.local_storage_prefix+"."+t.app_id+"."+e}function x(e){return function(e){try{return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode("0x"+t)}))}catch(e){u.error("Could not encode value\n",e)}}(JSON.stringify(e))}function S(e,n,r,o,i,s){if(arguments.length>1)return"object"==typeof n&&(n=x(n)),t.cookie=I(e)+"="+n+(r?"; expires="+new Date(+new Date+1e3*r).toUTCString():"")+(o?"; path="+o:"")+(i?"; domain="+i:"")+(s?"; secure":"");return w(unescape((("; "+t.cookie).split("; "+I(e)+"=")[1]||"").split(";")[0]))}function E(e){t.cookie=I(e)+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function L(){return S("session")}function O(){return S("user")}function j(){return u.log("trace","create new sessionId"),g()}function T(){const e=o(),t=y(),n=e.event.props;u.log("trace","set event props cookie",n),S("event.props",n,t.session.length,t.cookie.path)}function C(){const e=y(),t={id:e.session.id,libVersion:e.lib_v,startTime:e.session.startTime,ts:_()};u.log("trace","set session cookie for",e.session.length),S("session",t,e.session.length,e.cookie.path)}function P(e,t){const n=o(),r=(new Date).getTime();e.d=r;const i=e.hasOwnProperty("s")?e.s:t;var s;u.log("debug","hit: "+i,{app_id:(s=e).a,event_id:s.b,device_time:s.c,event_sent_time:s.d,lib:s.e,lib_v:s.f,user_id:s.g,identity:s.h,session_id:s.i,pageview_id:s.j,page_url:s.k,page_title:s.l,page_referrer:s.m,device_view_height:s.n,device_view_width:s.o,device_view_x:s.p,device_view_y:s.q,event_action:s.r,event_type:s.s,event_properties:s.t,session_start_time:s.u,element_hierarchy:s.v,element_id:s.w,element_name:s.x,element_class:s.y,element_text:s.z,element_node_name:s.aa,element_context_name:s.bb});const a=x(e);let c="t";t&&("set_user_properties"==t&&(c="u"),"identify"==t&&(c="t")),function(...e){const t=arguments[0],n=new Image(1,1);n.onload=function(){},n.onerror=function(){},n.src=t}(`${n.api_url}/${c}?d=${a}&st=${r}`)}function A(t={}){const n=o(),r=y();let s=r.user.hasViewedFirstPage,a=n.page.location,c=n.page.title,l=r.referrer.location,d=r.referrer.title;t&&(t.page&&(s&&(l=n.page.location),a=e.location.origin+t.page),t.title&&(s&&(d=n.page.title),c=t.title)),s=!0,i({page:{location:a,pageviewId:(u.log("trace","create new pageviewId"),g()),title:c}}),v({referrer:{location:l,title:d},user:{hasViewedFirstPage:s}}),delete t.page,delete t.title,P(V("pageview",t)),o().page.props={}}function N(e){u.log("trace","session no longer set; creating new session"),v({session:{hasStarted:!1,id:j(),startTime:(new Date).getTime()}}),C(),T(),"pageview"!==e&&A()}function $(){u.log("trace","set user cookie");const e=y();S("user",{identity:e.user.identity,libVersion:e.lib_v,sessionId:e.session.id,ts:_(),userId:e.user.id},e.cookie.duration,e.cookie.path)}function V(t,n={},r){let s=o(),a=y();if(n.page){i({page:{location:0==n.page.indexOf("/")?`${e.location.origin}${n.page}`:n.page}})}if(n.title&&i({page:{title:n.title}}),L()||N(t),a.user.id||(u.log("debug","User does not exist or session no longer set. Creating new user"),v({user:{id:f()}}),$()),!O()){v({user:{id:a.user.id||f()}}),$()}a=y();const c=(new Date).getTime(),l=e,d={a:s.app_id,b:g(),c:c,d:c,e:a.lib,f:a.lib_v,g:a.user.id,h:a.user.identity,i:a.session.id,j:s.page.pageviewId,k:s.page.location,l:s.page.title,m:m(),n:l.innerHeight,o:l.innerWidth,p:l.screenX,q:l.screenY,r:void 0,s:t,t:p(n,t),u:a.session.hasStarted?a.session.startTime:void 0,v:void 0,w:void 0,x:void 0,y:void 0,z:void 0,aa:void 0,bb:void 0};if(r){const{el:e,hierarchy:t,textContent:n,textValue:o}=r;d.v=t,d.w=e.getAttribute("id"),d.x=e.name,d.y=k(e.className),d.z=n,d.aa=e.nodeName?e.nodeName.toLowerCase():null,d.bb=o}return"identify"!==t&&v({session:{hasStarted:!0}}),u.log("trace","Context for send event",d),u.log("trace","Settings here",a),d}function U(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function F(e,t){if(!t||U(t,"html")||!function(e){return e&&1===e.nodeType}(t))return!1;switch(t.tagName.toLowerCase()){case"html":return!1;case"form":return"submit"===event.type;case"select":return"change"===event.type;default:return"click"===event.type}}function D(e){return t=>{let n=o().autotrack[e];u.log("debug",`autotrack: ${e}`,n?t:"tracking disabled for event type");let r=t.target;if(function(e){return e&&3===e.nodeType}(r)&&(r=r.parentNode),!n||!F(0,r))return;if(!function(e){if(k(e).split(" ").includes("dc-include"))return!0;for(let t=e;t.parentNode&&!U(t,"body");t=t.parentNode)if(t.getAttribute("dc-ignore"))return!1;if(U(e,"input")||U(e,"select")||U(e,"textarea")||"true"===e.getAttribute("contenteditable"))return!1;const t=e.type||"";if("string"==typeof t)switch(t.toLowerCase()){case"hidden":case"password":return!1}const n=e.name||e.id||"";if("string"==typeof n&&/^cc|cardnum|ccnum|creditcard|csc|cvc|cvv|exp|pass|pwd|routing|seccode|securitycode|securitynum|socialsec|socsec|ssn/i.test(n.replace(/[^a-zA-Z0-9]/g,"")))return!1;return!0}(r))return void u.log("debug","not tracking element due to dc-ignore");const i=function(e){const t=o(),n=e.target||e.srcElement,r=function(e){let t="";return e.reverse().forEach(e=>{if(e.nodeName&&-1==["HTML","#document","SHADOW","BODY","#document-fragment"].indexOf(e.nodeName)){const n=e.id;let r="@"+e.nodeName.toLowerCase()+";";if(n&&(r+="#"+n+";"),e.className&&e.className.split){let t=e.className.split(" "),n="";t.sort().forEach(e=>{n+="."+e+";"}),r+=n}if(e.dataset){let t="";for(const n in e.dataset)t+="[data-"+n+"="+e.dataset[n]+"];";r+=t}e.name&&(r+="[name="+e.name+"];"),e.type&&"fieldset"!==e.type&&"select-one"!==e.type&&(r+="[type="+e.type+"];"),e.method&&(r+="[method="+e.method+"];"),e.href&&(r+="[href="+e.href+"];"),t+=r+"|"}}),t}(e.path||e.composedPath&&e.composedPath()||[]);let i;return e&&t.capture_text&&(n.type?"password"!==n.type&&(i=n.selectedIndex?n.options[n.selectedIndex].text:n.value):i=n.innerText||n.textContent),{el:n,hierarchy:r,textContent:void 0,textValue:i}}(t),s=V(e,{},i);P(Object.assign({},s))}}function H(){const e=o(),n=t,r=n.body,i=n.documentElement,s=Math.max(r.scrollHeight,r.offsetHeight,i.clientHeight,i.scrollHeight,i.offsetHeight),a={};for(let t=0,n=e.track_page_scroll_depths.length;t<n;t++){const n=e.track_page_scroll_depths[t];100==n?a[100]=s-5:a[n]=s*(n/100)}return a}let R=0,G=H();function q(){const{pageviews:t,previousPage:n}=y(),r=e.innerHeight,o=e.scrollY+r;e.location.pathname,e.location.search;R!=t&&(R=t,G=H());const i=function(e){let t=null,n=null;const r=Object.keys(G);for(let o=0,i=r.length;o<i;o++){const i=r[o];if("null"===i)continue;const s=G[i];s&&e>=s&&(n?n=Math.min(n,s):(t=i,n=s))}return G[t]=0,parseInt(t)}(o);if(i){P(V("scroll",{scroll_depth_percentage:i,scroll_direction:"vertical"}))}}function z(e,t){o().track_page_scroll&&e.addEventListener("scroll",function(e,t){let n=null;return function(){n||(e.apply(this,arguments),n=setTimeout(()=>n=null,t))}}(q,50),!0)}let B=!1;function J(e){l(e=e||"debug"),i({debug:B=!0}),u.log("trace","debug enabled");const t=y();"browser"==t.mode&&S("debug",{debug:!0,level:e},t.cookie.duration,t.cookie.path)}function M(){const e=S("debug");let t=!1;e&&e.debug&&(t=!0),t&&J(e.level||"debug")}function Y(e,t,n){const r=O(),o=L(),s=o&&o.id&&o.startTime;if(s&&(o.hasStarted=!0),n.hasLink){let e={};n.linkIdentity||(e.identity=r.identity),v({session:{cookie:o,hasStarted:!0},user:e})}else if(r&&r.userId){u.log("trace","User exists but no _dclink present"),v({session:s?o:{id:j(),startTime:_()},user:{id:r.userId||f(),identity:r.identity}})}else{u.log("debug","User not set"),v({session:s?o:{id:n.linkSessionId||j(),startTime:n.linkSessionStart?parseInt(n.linkSessionStart):_()},user:{id:n.linkUserId||f()}})}i({event:{props:S("event.props")}}),C(),$(),T()}function W(e){P(function(e){const t=V("set_user_properties",e);return{a:t.a,b:t.b,c:t.c,d:t.d,e:t.e,f:t.f,g:t.g,h:t.h,i:t.i,t:t.t}}(e),"set_user_properties")}const X={clear:function(){const e=arguments[1];switch(e){case"event_properties":E("event.props"),o().event.props={};break;case"page_properties":o().page.props={};break;default:u.error(`Action "${e}" is not a valid on clear.`)}},get:function(){const e=(L()||N(null),y().session),t=y(),n=t.user.identity,r=arguments[1];switch(r){case"identity":return t.user.identity;case"linker_param":const o=n?`_${btoa(n)}`:"";return`${t.user.id}_${e.id}_${e.startTime}${o}`;case"session_id":return e.id;case"session_start_time":return e.startTime;case"tracker_param":return n?btoa(n):null;case"tracker_version":return t.trackerVersion;case"user_id":return t.user.id;default:console.log(`Invalid parameter "${r}" for get.`)}},identify:function(e,t){const n=y(),r=n.user?n.user.identity:null;r&&r==t||(v({user:{identity:t}}),$(),u.log("trace","Identity set",t),P(V("identify"),"identify"))},pageview:function(){Z("track","pageview",arguments[1])},set:function(){const e=arguments[1];let t=arguments[2];switch(e){case"debug":const n=t.enable,r=t.level;n?J(r):(u.log("info","debug disabled"),l("silent"),i({debug:B=!1}),"browser"==y().mode&&E("debug"));break;case"event_properties":!function(e){i({event:{props:e}}),T()}(t),u.log("trace","Set event props:",t);break;case"log_level":i({log_level:t});break;case"page_properties":!function(e){i({page:{props:e}})}(t),u.log("trace","Set page props:",t);break;case"user_properties":W(t),u.log("trace","Set user props:",t);break;default:u.error(`Action "${e}" is not a valid on set.`)}},track:function(){const e=arguments[1],t=arguments[2];switch(e){case"pageview":A(t);break;case"scroll":!function(e){const t=o().track_page_scroll_depths,n=e.scroll_depth_percentage;n&&-1==t.indexOf(n)&&(t.push(n),i({scroll_depth_percentage:t}))}(t);break;default:!function(e,t){P(V(e,t))}(e,t)}},unset:function(){const e=arguments[1];let t=arguments[2];switch(e){case"event_properties":!function e(t){const n=o();let r=[];if(t instanceof Array)for(let n=0,r=t.length;n<r;n++)e(t[n]);else r="string"==typeof t?[t]:Object.keys(t);for(let e=0,t=r.length;e<t;e++){const t=r[e];delete n.event.props[t]}T()}(t);break;case"page_properties":!function e(t){const n=o();let r=[];if(t instanceof Array)for(let n=0,r=t.length;n<r;n++)e(t[n]);else r="string"==typeof t?[t]:Object.keys(t);for(let e=0,t=r.length;e<t;e++){const t=r[e];delete n.page.props[t]}}(t);break;default:u.error(`Action "${e}" is not a valid on unset.`)}}};function Z(...e){const t=arguments[0],n=X[t];if(n)return n.apply(null,arguments);u.error(`Primary action "${t}" is not valid.`)}Z.debug=(e=>{Z("set","debug",{level:e,enable:!0})}),Z.get=function(...e){return Z("get",...e)},Z.identify=function(...e){return Z("identify",...e)};const K=[];let Q=null;function ee(t){b.pageviews++;const n=e.location.href;K.unshift(n),K.length>2&&K.pop(),v({previousPage:Q=K[1]}),o().track_history_change&&Z("track","pageview")}function te(e,t){o().track_pageview&&(Z("track","pageview"),function(e,t){u.log("debug","Tracking additional pageviews");const n=e.history,r=n.pushState,o=n.replaceState;n.pushState=function(){r.apply(n,arguments),ee()},n.replaceState=function(){o.apply(n,arguments),ee()}}(e))}function ne(e){for(let t=0,n=e.length;t<n;t++){Z(...e[t])}}function re(e,t){const n=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),r=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(e);try{return null===r||r&&"string"!=typeof r[1]&&r[1].length?"":decodeURIComponent(r[1]).replace(/\+/g," ")}catch(e){return""}}var oe,ie;function se(e,t){const n=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),r=new RegExp("[\\?&]"+n+"(\\w+)=([^&#]*)","g");let o;try{let t={};do{(o=r.exec(e))&&3===o.length&&(t[o[1]]=o[2])}while(o);return t}catch(e){return{}}}function ae(e,t){let n={};const r=re(e.location.href,ie.Event);r&&(u.log("debug","Found event param:",r),n.hasEvent=!0,Z("track",r));const o=re(e.location.href,ie.Identify);o&&(u.log("debug","Found identify param:",o),n.hasIdentity=!0,Z("identify",[o]));const i=re(e.location.href,ie.IdentifyEncoded);if(i){const e=ce(i);u.log("debug","Found encoded identify param:",e),n.hasIdentity=!0,e&&Z("identify",[e])}const s=re(e.location.href,ie.AnonymousId);s&&(u.log("debug","Found anonymous id param:",s),n.hasAnonymousId=!0,v({user:{id:s}}));const a=re(e.location.href,ie.Link);if(a){const e=function(e){const t=e.split("_"),n=t[0],r=t[1],o=t[2];let i=t[3];r&&u.log("debug","found linked sessionId: ",r);n&&u.log("debug","found linked userId: ",n);o&&u.log("debug","found linked session start: ",o);i&&(i=ce(i));return{linkUserId:n,linkSessionId:r,linkSessionStart:o,linkIdentity:i}}(a),{linkSessionId:t,linkUserId:r,linkSessionStart:o,linkIdentity:i}=e;if(n.linkSessionId=t,n.linkSessionStart=o,n.linkIdentity=i,n.linkUserId=r,Boolean(t)&&Boolean(r)&&Boolean(o)){n.hasLink=!0,v({session:{hasStarted:!0,id:t,startTime:o?parseInt(o):_()},user:{id:r,identity:i}})}}const c=se(e.location.href,ie.EventPropertyPrefix);c&&Object.keys(c).length>0&&(u.log("debug","Found event property params:",c),n.hasEventProperties=!0,Z("set","event_properties",c));const l=se(e.location.href,ie.PagePropertyPrefix);return l&&Object.keys(l).length>0&&(u.log("debug","Found page property params:",l),n.hasPageProperties=!0,Z("set","page_properties",l)),n}function ce(e){try{e=atob(e)}catch(e){console.error("Linked identity is not a string"),console.error(e)}return u.log("debug","found linked identity: ",e),e}function le(e,t,n,r){let o;const s=n||(e&&e.__dc__&&e.__dc__.c?e.__dc__.c:{}),a=s.namespace||"deepchannel";c=a,delete s.b,delete s.n,u.log("debug","Deep Channel Running\n",s),s&&(o=i(Object.assign({},s,{page:{location:e.location.href}})));const l={mode:"browser",referrer:{location:t.referrer},trackerVersion:r};s.session_length&&(l.session={length:s.session_length}),v(l),M(),Y(0,0,ae(e)),function(e,t,n){const r=e[n].q;if(delete e.deepchannel.q,r instanceof Array&&r.length>0){const e=[],t=[],n=[],o=[],i=[],s=[],a=[];for(let c=0,l=r.length;c<l;c++){const l=r[c];switch(l[0]){case"identify":e.push(l);break;case"clear":o.push(l);break;case"unset":n.push(l);break;case"set":t.push(l);break;case"pageview":i.push(l);break;case"track":s.push(l);break;default:a.push(l)}}ne(e),ne(t),ne(n),ne(o),ne(i),ne(s),ne(a)}}(e,0,a),te(e),function(e,t){u.log("trace","Autotrack enabled"),e.addEventListener("change",D("change")),e.addEventListener("click",D("click")),e.addEventListener("submit",D("submit"))}(e),z(e);const d=e[a].__r;if(e[a]=Z,"function"==typeof d)try{d()}catch(e){console.error("Could not execute ready callback"),console.error(e)}return Z}e.addEventListener("popstate",function(){ee()},!1),function(e){e[e.critical=0]="critical",e[e.debug=1]="debug",e[e.error=2]="error",e[e.info=3]="info",e[e.silent=4]="silent",e[e.trace=5]="trace",e[e.warn=6]="warn"}(oe||(oe={})),function(e){e.Event="_dc_e",e.Identify="_dc_i",e.IdentifyEncoded="_dc_ie",e.AnonymousId="_dc_uid",e.Link="_dclink",e.EventPropertyPrefix="_dc_sprops_",e.PagePropertyPrefix="_dc_pprops_"}(ie||(ie={})),le(e,t,null,211)}(window,document);